<!--index.wxml-->
<view class="container">
  <!-- 顶部导航 -->
  <van-nav-bar
    title="2024年3月"
    right-text="预算设置"
    bind:click-right="onClickRight"
    custom-class="nav-bar"
  />

  <!-- 预算进度卡片 -->
  <view class="budget-card">
    <view class="budget-title">本月预算</view>
    <view class="budget-circle">
      <van-circle
        value="{{ budgetPercentage }}"
        color="#424874"
        layer-color="#DCD6F7"
        text="剩余预算\n¥3000"
        text-color="#424874"
        stroke-width="8"
        size="180"
      />
    </view>
    <view class="budget-info">
      <view class="budget-item">
        <text class="label">总预算</text>
        <text class="value">¥5000</text>
      </view>
      <view class="budget-item">
        <text class="label">已使用</text>
        <text class="value expense">¥2000</text>
      </view>
    </view>
  </view>

  <!-- 今日账单卡片 -->
  <view class="today-bills">
    <view class="section-header">
      <text class="section-title">今日账单</text>
      <text class="today-total">支出 ¥128</text>
    </view>
    
    <view class="bill-list">
      <van-swipe-cell right-width="{{ 65 }}" wx:for="{{ bills }}" wx:key="id">
        <van-cell
          title="{{ item.category }}"
          label="{{ item.note }}"
          value="{{ item.amount }}"
          value-class="{{ item.type === 'expense' ? 'expense' : 'income' }}"
          icon="{{ item.icon }}"
          custom-class="bill-item"
        />
        <view slot="right" class="delete-btn">删除</view>
      </van-swipe-cell>
    </view>
  </view>

  <!-- 记账按钮 -->
  <view class="btn-create" bindtap="showBillPopup">
    <van-icon name="plus" size="24px" color="#F4EEFF"/>
    <text>记一笔</text>
  </view>

  <!-- 记账弹窗 -->
  <bill-input 
    show="{{showBillInput}}" 
    bind:close="onBillInputClose"
    bind:save="onBillSave"
  />
</view>

<custom-tab-bar id="footer-nav-bar-id" />